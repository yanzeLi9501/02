# 2018March-NovemberProject

Consistent alterations of human fecal microbes after transplanted to germ-free mice
=================================================================================================================================
This is a description file.
=================================================================================================================================
The main analysis script is /Fig1_FigS2/boxplot_log2foldChange.R

* The main purpose of this script is to perform statistics on the file types generated by mapseq, and then perform a one-to-one comparison based on the statistical results.

* The input file list_all.xlsx in this script is the Supplementary Table S2 in our article. This table contains experimental conditions and the corresponding sample RunIDs.

* This script first counts the relative abundance level of bacteria at the species level, and then counts the relative abundance level of bacteria at the genus level. For both levels of statistics, bacteria with the lowest relative abundance greater than 0.1% were selected as the criterion.

* The output files of this script are plot1 and plot1.genus, plot1 is the relative change in bacterial abundance at the species level before and after fecal transplantation, and plot1.genus is the relative change in bacterial abundance at the genera level before and after fecal transplantation, which is used to draw statistical results It should be saved as an important output file and will be used for subsequent analysis.

* The function 'df.genus.reduced' and 'df.species.reduced' conatins the relative abundance of human and mouse samples and their  relative change 'm2h'. The files 'Species_foldChange_position.csv' and 'Genus_foldChange_condition.csv' in the csv format under this directory are from the statistical results of this file. The criterion for judging whether it is increase or decrease is to take log2 for 'm2h'. We use greater than 1 or less than -1 as the judgment standard.

The heatmap script is /Fig3/heatmap3.2.r. The script used to draw the heatmap comes from the heatmap3 package in R. 
* The main files used in the script are derived from the abundance of the corresponding bacteria under each experimental condition after the 'df.genus.reduced'/'df.species.reduced' file and the 'Supplementary Table S2' file are merged. The bacteria here only draw bacteria that we think have changed significantly (log2 | â‰¥1). The merged file uses the 'aggregate' function of the R language to get the median value of the corresponding bacteria under each experimental condition.
* File x and file y are the files used to draw the corresponding rowside color and colside color, where file x represents the prevelence of these bacteria that appear in the experimental conditions. File y indicates that each experimental condition is divided into two categories according to whether they are controlled diet.
* Files 'frac_light.r' and 'frac_rgb.r' are palette script. The colors of 'rowside' and 'colside' can be changed by changing the color parameters in these two files.

The script used to make the timeline change for the enterotype is /Fig4/TimeLinePlot3Enterotyep.R.
* The input file 'TimeLine6SplitEnterotype.csv' It is the ratio of samples that had enterotype changes within 6/12/18/28/38/48 days after transplantation compare to the original enterotype.

All boxplots and R scripts comparing human and mouse differences in the article are in the Fig5_Fig6_FigS8_FigS9 directory.

* The file /Fig5_Fig6_FigS8_FigS9/genus_df_h233.csv This file includes the relative abundance of bacteria at the genus level in all samples and the experimental conditions corresponding to these samples. This file is a combination of experimental condition file and file Genus_reducedAll_Percent.csv. Statistics related to species level are obtained by mergeing the experimental condition form with the 'Species_reducedAll_Percent.csv' file

The script /FigS10/condition_denisty.r. Is a density plot used for showing different experimental conditions.
* This figure is drawn according to 'Supplementary Table S2', so the input file is the corresponding sample and experimental conditions in 'Supplementary Table S2' file. (In supplementary materials of the manuscript)
* The file 'list_condition_complex.csv' is a much more complex experimental condition form, that explain why we didn't use this analysis strategy. 

The script /FigS6/DotPlot.r is quite complex.  
* The file 'Genus_log2Human.csv' and 'Genus_log2Mouse.csv' are corresponding to the two cases of feeding mice with human food and feeding mice with mouse food, the relative abundance (cut off 0.1%) of genera change and the proportion of log2 fold change.
* The file 'Species_log2Human.csv' and 'Species_log2Mouse.csv' are corresponding to the two cases of feeding mice with human food and feeding mice with mouse food, the relative abundance (cut off 0.1%) of species change and the proportion of log2 fold change.
* The file 'Species_foldChangeAll.csv' and 'Genus_foldChangeAll.csv' are over all relative abundance (cut off 0.1%) change of all our human-mouse pairs.
